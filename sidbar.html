<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
<style>
    * {margin : 0;padding : 0;}
    .scroll-wrap{
        width: 500px;
        height: 600px;
        margin: 20px auto;
    }
    .scroll-content{
        float: left;
        margin-left: 0;
        width: 480px;
        height: 300px;
        overflow-y: hidden;
        border: 1px solid red;
    }
    .scroll-content ul{
        margin-top: 0;
        float: left;
        width: 200px;
        border: 1px solid green;
        height:auto;
    }
    .slider{
        float: right;
        margin-right: 0;
        width: 10px;
        /*height: 300px;*/
        background: rgb(223, 158, 158);
        position: relative;
    }
    .sliderBar{
        width: 10px;
        /*height: 20px;*/
        background: blue;
    }
</style>
    <title>Document</title>
</head>
<body>
    <div class="scroll-wrap scroll-part">
        <div class="scroll-content scroll-part" id="scroll-content">
            <ul class="scroll-content-item scroll-part">
                <li class="scroll-part">11111111111111111111111hhhhhhhhhh</li>
                <li class="scroll-part">hhhhhhhhhh</li>
                <li class="scroll-part">hhhhhhhhhh</li>
                <li class="scroll-part">hhhhhhhhhh</li>
                <li class="scroll-part">hhhhhhhhhh</li>
                <li class="scroll-part">hhhhhhhhhh</li>
                <li class="scroll-part">hhhhhhhhhh</li>
                <li class="scroll-part">hhhhhhhhhh</li>     
                <li class="scroll-part">hhhhhhhhhh</li>
                <li class="scroll-part">hhhhhhhhhh</li>
                <li class="scroll-part">hhhhhhhhhh</li>
                <li class="scroll-part">hhhhhhhhhh</li>     
                <li class="scroll-part">hhhhhhhhhh</li>
                <li class="scroll-part">hhhhhhhhhh</li>
                <li class="scroll-part">hhhhhhhhhh</li>
                <li class="scroll-part">hhhhhhhhhh</li>
                <li class="scroll-part">hhhhhhhhhh</li>     
                <li class="scroll-part">hhhhhhhhhh</li>
                <li class="scroll-part">hhhhhhhhhh</li>
                <li class="scroll-part">hhhhhhhhhh</li>
                <li class="scroll-part">hhhhhhhhhh</li>
                <li class="scroll-part">hhhhhhhhhh</li>
                <li class="scroll-part">hhhhhhhhhh</li>     
                <li class="scroll-part">hhhhhhhhhh</li>
                <li class="scroll-part">hhhhhhhhhh</li>
                <li class="scroll-part">hhhhhhhhhh</li>
                <li class="scroll-part">hhhhhhhhhh</li>
                <li class="scroll-part">hhhhhhhhhh</li>
                <li class="scroll-part">hhhhhhhhhh</li>     
                <li class="scroll-part">hhhhhhhhhh</li>
                <li class="scroll-part">hhhhhhhhhh</li>
                <li class="scroll-part">hhhhhhhhhh</li>
                <li class="scroll-part">hhhhhhhhhh</li>
                <li class="scroll-part">hhhhhhhhhh</li>
                <li class="scroll-part">hhhhhhhhhh</li>
                <li class="scroll-part">hhhhhhhhhh</li>
                <li class="scroll-part">hhhhhhhhhh</li>     
                <li class="scroll-part">hhhhhhhhhh</li>
                <li class="scroll-part">hhhhhhhhhh</li>
                                     
            </ul>
            <ul class="scroll-content-item scroll-part">
                <li class="scroll-part">hhhhhhhhhh</li>
                <li class="scroll-part">hhhhhhhhhh</li>
                <li class="scroll-part">hhhhhhhhhh</li>
                <li class="scroll-part">hhhhhhhhhh</li>  
                <li class="scroll-part">hhhhhhhhhh</li>
                <li class="scroll-part">hhhhhhhhhh</li>
                <li class="scroll-part">hhhhhhhhhh</li>
                <li class="scroll-part">hhhhhhhhhh</li>     
                <li class="scroll-part">hhhhhhhhhh</li>
                <li class="scroll-part">hhhhhhhhhh</li>
                <li class="scroll-part">hhhhhhhhhh</li>
                <li class="scroll-part">hhhhhhhhhh</li>
                <li class="scroll-part">hhhhhhhhhh</li>
                <li class="scroll-part">hhhhhhhhhh</li>
                <li class="scroll-part">hhhhhhhhhh</li>
                <li class="scroll-part">hhhhhhhhhh</li>
                <li class="scroll-part">hhhhhhhhhh</li>     
                <li class="scroll-part">hhhhhhhhhh</li>
                <li class="scroll-part">hhhhhhhhhh</li>
                <li class="scroll-part">hhhhhhhhhh</li>
                <li class="scroll-part">hhhhhhhhhh</li>
                <li class="scroll-part">hhhhhhhhhh</li>
                <li class="scroll-part">hhhhhhhhhh</li>     
                <li class="scroll-part">hhhhhhhhhh</li>
                <li class="scroll-part">hhhhhhhhhh</li>
                <li class="scroll-part">hhhhhhhhhh</li>
                <li class="scroll-part">hhhhhhhhhh</li>
                <li class="scroll-part">hhhhhhhhhh</li>
                <li class="scroll-part">hhhhhhhhhh</li>     
                <li class="scroll-part">hhhhhhhhhh</li>
                <li class="scroll-part">hhhhhhhhhh</li>
                <li class="scroll-part">hhhhhhhhhh</li>
                <li class="scroll-part">hhhhhhhhhh</li>
                <li class="scroll-part">hhhhhhhhhh</li>
                <li class="scroll-part">hhhhhhhhhh</li>
                <li class="scroll-part">hhhhhhhhhh</li>
                <li class="scroll-part">hhhhhhhhhh</li>     
                <li class="scroll-part">hhhhhhhhhh</li>
                <li class="scroll-part">hhhhhhhhhh</li>
                                              
            </ul>
        </div>
        <div class="slider">
            <div class="sliderBar"></div>
        </div>
    </div>
</body>
    

<script type = "text/javascript" >
    // 单位滚动高度20px
    //根据内容高度设置其他高度

    　　var slider = document.getElementsByClassName('slider')[0];
        var sliderBar=document.getElementsByClassName("sliderBar")[0];　　
        var scrollContent=document.getElementsByClassName('scroll-content')[0];

        ul=document.getElementsByClassName("scroll-content-item");
        ul[0].style.marginTop=0+'px';
        ul[1].style.marginTop=0+'px';
        sliderBar.style.marginTop=0+'px';

        var single=0;
        var sliderBarSingle;
        ulHeight=ul[0].offsetHeight;
        // scrollContent.style.height=ulHeight+'px';
        slider.style.height=scrollContent.offsetHeight+'px';
        var dis=ul[0].offsetHeight-scrollContent.offsetHeight;
        // alert();
        // alert(this.scrollContent.offsetHeight);
        // alert(this.ul[0].offsetHeight);
        //动态设置滚动条的长度
        if(scrollContent.offsetHeight>=ul[0].offsetHeight){
            sliderBar.style.height=0+'px';
        }else{
            // alert(dis/20);
            sliderBarSingle=slider.offsetHeight/(dis/20);            
            sliderBar.style.height=slider.offsetHeight/(dis/sliderBarSingle)+'px';
        }
        sliderBar.onmousedown = function(event) {　　
    　　　　event = event || window.event;
            console.log(event.clientY);
    　　　　var evTop = event.clientY - sliderBar.offsetTop;
    　　　　document.onmousemove = function(event) {
    　　　　　　event = event || window.event;
    　　　　　　var changeTop = event.clientY - evTop;
    　　　　　　if(changeTop < 0) {
    　　　　　　　　changeTop = 0;
    　　　　　　} else if (changeTop > (slider.offsetHeight - sliderBar.offsetHeight) ) {
    　　　　　　　　changeTop = slider.offsetHeight - sliderBar.offsetHeight;
    　　　　　　}
    　　　　　　sliderBar.style.marginTop = changeTop + 'px';
              //获取sliderBar的offsetTop与slider的比值
    　　        var scale = sliderBar.offsetTop/(slider.offsetHeight - sliderBar.offsetHeight);
    　　        var scrollContentTop = (scrollContent.offsetHeight - ul[0].offsetHeight) * scale;  
    　　　　　　ul[0].style.marginTop = scrollContentTop + 'px';
                ul[1].style.marginTop = scrollContentTop + 'px';
    　　　　}
    　　　　document.onmouseup = function() {
    　　　　　　document.onmousemove = null;
    　　　　}
    　　}
    //滚轮控制
    console.log(dis);
    scrollContent.onmousewheel=function(e){
        document.onmousewheel=null;
        var e=e||window.event;
        
        if(e.target.className=='scroll-part'){
            var scrollContentTop=parseInt(ul[0].style.marginTop);
            var top=scrollContentTop;
            var sliderBarTop=sliderBar.offsetTop;
            var sliderbarsingle;
            // alert(top);
                    if(e.wheelDelta<0){
                        //xia
                        if(top>=-dis && sliderBarTop<=slider.offsetHeight-sliderBar.offsetHeight){
                            single=-sliderBarSingle;
                            sliderbarsingle=sliderBarSingle;
                        }else{
                            single=0;
                            sliderbarsingle=0;
                        }
                    }else if(e.wheelDelta>0){
                        if(top<0  && sliderBarTop>=sliderBar.offsetHeight){
                            single=sliderBarSingle;
                            sliderbarsingle=-sliderBarSingle;
                        }else if(top>=0){
                            single=0;
                            sliderbarsingle=0;
                        }
                    }
            
            top+=single;
             ul[0].style.marginTop = top + 'px';
                ul[1].style.marginTop = top + 'px';
                sliderBar.style.marginTop=parseInt(sliderBar.style.marginTop)+sliderbarsingle+'px';
        }
    }
    </script>
</html>
